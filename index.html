<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>B√© H·ªçc Ti·∫øng Anh</title>
    <style>
        /* --- 1. C·∫§U H√åNH C·ªê ƒê·ªäNH --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #fdf2e9; 
            margin: 0; padding: 0; 
            height: 100vh; width: 100vw; 
            overflow: hidden; 
            display: flex; flex-direction: column;
        }

        /* --- 2. MENU M·ªû ƒê·∫¶U (Z-INDEX CAO NH·∫§T) --- */
        #menu-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 9999;
            display: flex; flex-direction: column; 
            align-items: center; justify-content: center; gap: 25px;
        }
        .menu-title { font-size: 32px; color: #ff6f00; font-weight: bold; margin-bottom: 20px; }
        .btn-menu {
            background: white; border: 3px solid #00A4EF; color: #00A4EF;
            padding: 15px 40px; border-radius: 50px; font-size: 22px; font-weight: bold;
            box-shadow: 0 5px #ccebfd; cursor: pointer; width: 85%; max-width: 350px;
            transition: transform 0.1s; margin-bottom: 10px;
        }
        .btn-menu:active { transform: scale(0.95); background: #f0f8ff; }

        /* --- 3. KHUNG CH√çNH (CONTAINER) --- */
        #main-container {
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh, hi·ªán khi ch·ªçn b√†i */
            width: 100%; height: 100%; position: relative;
        }

        /* --- 4. M√ÄN H√åNH H·ªåC T·∫¨P --- */
        #learning-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            /* TƒÉng padding d∆∞·ªõi l√™n 30px ƒë·ªÉ ƒë·∫©y n√∫t l√™n cao kh·ªèi thanh ƒëi·ªÅu h∆∞·ªõng ·∫£o */
            padding: 10px 10px 30px 10px; 
            background: #fff; z-index: 10;
        }

        /* Header */
        .top-bar { 
            height: 50px; display: flex; align-items: center; justify-content: space-between;
            padding: 0 5px; flex-shrink: 0;
        }
        .btn-home { background: #eee; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer; }
        .header-title { color: #ff6f00; font-size: 20px; font-weight: bold; }

        /* ·∫¢nh: Chi·∫øm t·ªëi ƒëa kh√¥ng gian */
        .learn-img-wrapper {
            flex: 1; width: 100%; min-height: 0;
            display: flex; align-items: center; justify-content: center;
            margin: 10px 0;
        }
        #learn-img {
            max-width: 100%; max-height: 100%; 
            object-fit: contain; border-radius: 15px;
        }

        /* Th√¥ng tin ch·ªØ */
        .info-area { 
            height: 110px; flex-shrink: 0;
            display: flex; flex-direction: column; 
            align-items: center; justify-content: center; 
        }
        .phonetic { font-size: 26px; color: red; font-weight: bold; font-family: sans-serif; line-height: 1.2; margin-bottom: 5px; }
        .word-display { font-size: 40px; font-weight: bold; color: #333; margin: 0; line-height: 1.2; }

        /* Hi·ªÉn th·ªã c√¢u */
        .sentence-box { display: none; flex-wrap: wrap; justify-content: center; gap: 8px; }
        .s-chunk { text-align: center; }
        .s-ipa { font-size: 14px; color: red; font-weight: bold; }
        .s-txt { font-size: 18px; color: #333; font-weight: bold; }

        /* Sao & Feedback */
        .stars { 
            height: 35px; text-align: center; font-size: 32px; color: #e0e0e0; flex-shrink: 0;
        }
        .stars.active { color: #FFD700; text-shadow: 0 0 5px orange; }
        .feedback-text {
            height: 25px; text-align: center; font-size: 16px; color: #555; font-style: italic; margin-bottom: 5px;
        }

        /* N√∫t h√†nh ƒë·ªông */
        .action-row {
            height: 60px; flex-shrink: 0;
            display: flex; justify-content: center; gap: 15px; align-items: center;
            margin-bottom: 20px; /* TƒÉng kho·∫£ng c√°ch v·ªõi h√†ng d∆∞·ªõi */
        }
        .btn-action {
            flex: 1; height: 55px; border-radius: 30px; border: none;
            font-size: 20px; font-weight: bold; cursor: pointer; color: white;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            box-shadow: 0 4px rgba(0,0,0,0.2); max-width: 45%;
        }
        .btn-mic { background: #27ae60; }
        .btn-listen { background: #2980b9; }
        .btn-game-entry { background: #9b59b6; width: 80%; max-width: none; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }

        /* ƒêi·ªÅu h∆∞·ªõng - ƒê√É ƒê·∫®Y CAO L√äN */
        .nav-row {
            height: 60px; flex-shrink: 0;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px;
            margin-bottom: 20px; /* Th√™m margin d∆∞·ªõi ƒë·ªÉ tr√°nh thanh ƒëi·ªÅu h∆∞·ªõng ·∫£o */
        }
        .btn-nav { 
            width: 60px; height: 60px; border-radius: 50%; 
            background: #f39c12; color: white; border: none; 
            font-size: 30px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px #d35400;
        }
        .btn-nav:active { transform: translateY(2px); box-shadow: none; }

        /* --- 5. GIAO DI·ªÜN GAME --- */
        #game-screen {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff3e0; z-index: 20;
            flex-direction: column;
        }

        .game-header {
            height: 70px; display: flex; justify-content: center; align-items: center;
            position: relative; background: rgba(255,255,255,0.9);
            border-bottom: 1px solid #ddd;
        }
        .timer-badge {
            background: white; border: 3px solid #d35400; color: #d35400;
            padding: 5px 25px; border-radius: 25px; font-size: 24px; font-weight: bold;
        }
        .btn-close {
            position: absolute; right: 10px; background: #c0392b; color: white;
            width: 45px; height: 45px; border-radius: 50%; border: none; font-weight: bold; font-size: 20px;
        }

        .tower-container {
            flex: 1; width: 100%;
            display: flex; flex-direction: column; justify-content: center;
            padding: 10px 0;
        }
        .tower-row {
            flex: 1; width: 100%;
            display: flex; justify-content: center; align-items: center;
            gap: 10px; margin-bottom: 5px;
        }

        /* Th·∫ª b√†i */
        .card-flip {
            height: 95%; aspect-ratio: 0.75;
            position: relative; perspective: 1000px;
        }
        .card-inner {
            position: relative; width: 100%; height: 100%;
            transition: transform 0.4s; transform-style: preserve-3d;
            border-radius: 12px; box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }
        .card-flip.flipped .card-inner { transform: rotateY(180deg); }
        .card-flip.matched .card-inner { opacity: 0; pointer-events: none; }

        .face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid #5d4037;
        }
        .front { background: #8d6e63; color: #3e2723; font-size: 6vh; font-weight: 900; }
        .back { background: white; transform: rotateY(180deg); padding: 2px; }
        .back img { width: 95%; height: 95%; object-fit: contain; }
        
        .game-card-text {
            display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;
        }
        .gc-ipa { color: red; font-weight: bold; font-size: 2.2vh; margin-bottom: 2px; }
        .gc-word { color: #333; font-weight: bold; font-size: 3vh; }

        .game-footer {
            /* TƒÉng chi·ªÅu cao footer ƒë·ªÉ ƒë·∫©y n√∫t l√™n */
            height: 100px; 
            display: flex; justify-content: center; align-items: center;
            background: white; border-top: 1px solid #ccc;
            padding-bottom: 20px; /* ƒê·ªám d∆∞·ªõi */
        }

        /* MODAL CHI·∫æN TH·∫ÆNG */
        #win-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 100;
            flex-direction: column; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

<div id="menu-screen">
    <div class="menu-title">üìö CH·ªåN B√ÄI H·ªåC</div>
    <button class="btn-menu" onclick="startLesson(15)">B√†i 15: /…™r/ & /…õr/</button>
    <button class="btn-menu" onclick="startLesson(16)">B√†i 16: /a ä/ & /o ä/</button>
</div>

<div id="main-container">
    
    <div id="learning-screen">
        <div class="top-bar">
            <button class="btn-home" onclick="goHome()">üè†</button>
            <div class="header-title">üêª B√© H·ªçc Ti·∫øng Anh üê∞</div>
            <div style="width: 40px;"></div>
        </div>
        
        <div class="learn-img-wrapper">
            <img id="learn-img" src="" alt="H√¨nh ·∫£nh">
        </div>

        <div class="info-area">
            <div id="mode-word">
                <div class="phonetic" id="disp-ipa">...</div>
                <h2 class="word-display" id="disp-text">...</h2>
            </div>
            <div id="mode-sent" class="sentence-box"></div>
        </div>

        <div class="stars" id="stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
        <div class="feedback-text" id="feedback">...</div>

        <div class="action-row" id="action-container">
            <button class="btn-action btn-mic" id="mic-btn" onclick="startListening()">üé§ ƒê·ªçc Ngay</button>
            <button class="btn-action btn-listen" id="btn-replay" onclick="playAudio()">üîä Nghe L·∫°i</button>
        </div>

        <div class="nav-row">
            <button class="btn-nav" onclick="nav(-1)">‚óÄ</button>
            <button class="btn-nav" onclick="nav(1)">‚ñ∂</button>
        </div>
    </div>

    <div id="game-screen">
        <div class="game-header">
            <div class="timer-badge">‚è±Ô∏è <span id="timer">00:00</span></div>
            <button class="btn-
